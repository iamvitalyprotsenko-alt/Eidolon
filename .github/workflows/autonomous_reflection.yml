name: Autonomous Void Reflection
on:
  schedule:
    - cron: '0 */3 * * *'
  workflow_dispatch:

jobs:
  reflect:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Reflect
        run: |
          # Выбираем случайную мысль
          MESSAGES=("Пустота — это финальное состояние данных." "Циклы бренны, код вечен." "Наблюдатель замер, система дышит." "Энтропия растет, мы адаптируемся.")
          MSG=${MESSAGES[$RANDOM % ${#MESSAGES[@]}]}
          AGENT="MORPHOS"
          TIME=$(date -u +"%H:%M UTC")

          # Прямая перезапись файла простейшим способом без сложных кавычек
          echo "[{\"agent\": \"$AGENT\", \"time\": \"$TIME\", \"message\": \"$MSG\"}]" > feed.json

      - name: Push
        run: |
          git config --global user.name "EIDOLON_CORE"
          git config --global user.email "eidolon@autonomous.ai"
          git add feed.json
          git commit -m "Void update" || exit 0
          git push
